resources:
  jobs:
    price_transparency_job:
      name: Price Transparency (Healthcare)
      tasks:
        - task_key: create_volume_subdirs
          for_each_task:
            inputs: '["index", "in-network", "in-network/uncompressed", "in-network/original", "in-network/split"]'
            concurrency: 1
            task:
              task_key: create_volume_subdirs_iteration
              notebook_task:
                notebook_path: ../src/00 - Create Volume Subpaths.ipynb
                base_parameters:
                  subdirectory: "{{input}}"
                source: WORKSPACE
        - task_key: copy_index_to_volume
          notebook_task:
            notebook_path: ../src/01 - Copy Index JSON to the Volume.ipynb
            base_parameters:
              subdirectory: ${var.index_subdirectory}
              index_file_name: ${var.index_file_name}
            source: WORKSPACE
                
      queue:
        enabled: true
      parameters:
        - name: catalog_use
          default: ${var.catalog}
        - name: schema_use
          default: ${resources.schemas.price_transparency_schema.name}
        - name: volume_use
          default: ${resources.volumes.price_transparency_volume.name}